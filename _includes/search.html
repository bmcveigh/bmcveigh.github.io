<span id="search">
        <a
        class="search-link"
        href="#"
        v-on:click="handleSearchClick"
    >
        <i class="fa fa-search"></i>
    </a>
    <div class="search-wrap" v-if="showSearch">
        <form action="">
             <input
                type="text"
                placeholder="Enter keywords..."
                v-on:keyup="handleChange"
            />
        </form>
        <div class="search-results">
            <div class="search-result" 
                v-for="post in posts"
                >
                <a v-bind:href="post.url" v-text="post.title"></a>
            </div>
            <div v-if="!posts.length && keywords.length">
                <h3>No results found.</h3>
            </div>
            <div v-else-if="!posts.length && !keywords.length">
                <h3>Results will show up here as you type.</h3>
            </div>
        </div>
    </div>
</span>
<script>
    /**
     * Use VueJS to make the search functionality interactive.
     */
    var app = new Vue({
        el: '#search',
        data: {
            showSearch: false,
            keywords: '',
            posts: [],
        },
        methods: {
            handleSearchClick: function(event) {
                event.preventDefault();
                this.showSearch = !this.showSearch;
            },
            handleChange: async function(event) {
                if (!this.posts.length) {
                    this.posts = await fetch('/api/posts.json')
                    .then(res => res.json())
                    .then(json => json)
                    .catch(error => {
                        // catch error.
                    });
                }
                
                this.keywords = event.target.value;
                const filteredPosts = [];

                for (const post of this.posts) {
                    if (post.title.toLowerCase().indexOf(this.keywords.toLowerCase()) > -1) {
                        filteredPosts.push(post);
                    }
                }

                this.posts = filteredPosts;
            }
        }
    });
</script>
